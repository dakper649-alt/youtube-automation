"""
SEO Generator - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è SEO-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –¥–ª—è YouTube
3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤, –æ–ø–∏—Å–∞–Ω–∏–µ —Å —Ç–∞–π–º–∫–æ–¥–∞–º–∏, 30 —Ç–µ–≥–æ–≤
"""

from typing import Dict, List
import re


class SEOGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä SEO –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –¥–ª—è YouTube"""

    def generate_seo_metadata(
        self,
        title: str,
        script: str,
        niche: str,
        metadata: Dict
    ) -> str:
        """
        –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø–æ–ª–Ω—ã–π SEO —Ñ–∞–π–ª

        Args:
            title: –û—Å–Ω–æ–≤–Ω–æ–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
            script: –¢–µ–∫—Å—Ç —Å–∫—Ä–∏–ø—Ç–∞
            niche: –ù–∏—à–∞ –≤–∏–¥–µ–æ
            metadata: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

        Returns:
            –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–ª—è SEO_METADATA.txt
        """

        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
        titles = self._generate_title_variants(title, niche)

        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ
        description = self._generate_description(script, title, niche, metadata)

        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ç–µ–≥–∏
        tags = self._generate_tags(title, niche, script)

        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        stats = self._generate_stats(metadata)

        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Å—ë –≤ –∫—Ä–∞—Å–∏–≤—ã–π —Ç–µ–∫—Å—Ç
        seo_content = f"""
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
–ú–ï–¢–ê–î–ê–ù–ù–´–ï –î–õ–Ø YOUTUBE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

üìå –í–ê–†–ò–ê–ù–¢ 1 (–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π):
{titles[0]}

üìå –í–ê–†–ò–ê–ù–¢ 2 (–í–æ–ø—Ä–æ—Å):
{titles[1]}

üìå –í–ê–†–ò–ê–ù–¢ 3 (–¶–∏—Ñ—Ä—ã/–°–ø–∏—Å–æ–∫):
{titles[2]}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üìù –û–ü–ò–°–ê–ù–ò–ï:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

{description}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üè∑Ô∏è –¢–ï–ì–ò (30 —à—Ç—É–∫):
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

{' '.join(tags)}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

{stats}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π –í–ê–†–ò–ê–ù–¢ 1 –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ CTR (–∫–ª–∏–∫–æ–≤)
‚úÖ –î–æ–±–∞–≤—å custom –º–∏–Ω–∏–∞—Ç—é—Ä—É (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞)
‚úÖ –ó–∞–≥—Ä—É–∂–∞–π –≤ 18:00-20:00 –ø–æ –ú–°–ö –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –æ—Ö–≤–∞—Ç–∞
‚úÖ –ó–∞–∫—Ä–µ–ø–∏ –ø–µ—Ä–≤—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Å –≤–æ–ø—Ä–æ—Å–æ–º –∫ –∞—É–¥–∏—Ç–æ—Ä–∏–∏
‚úÖ –î–æ–±–∞–≤—å –≤–∏–¥–µ–æ –≤ –ø–ª–µ–π–ª–∏—Å—Ç –ø–æ –Ω–∏—à–µ: "{niche}"

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
"""

        return seo_content

    def _generate_title_variants(self, base_title: str, niche: str) -> List[str]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤"""

        # –í–∞—Ä–∏–∞–Ω—Ç 1: –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Å —ç–º–æ–¥–∑–∏
        variant1 = f"{base_title} (–≠—Ç–æ –ò–∑–º–µ–Ω–∏—Ç –í—Å—ë!) üî•"

        # –í–∞—Ä–∏–∞–Ω—Ç 2: –í–æ–ø—Ä–æ—Å
        if '?' not in base_title:
            variant2 = f"–ü–æ—á–µ–º—É {base_title}? ü§î"
        else:
            variant2 = base_title

        # –í–∞—Ä–∏–∞–Ω—Ç 3: –° —Ü–∏—Ñ—Ä–∞–º–∏
        variant3 = f"7 –§–∞–∫—Ç–æ–≤: {base_title} üìä"

        return [variant1, variant2, variant3]

    def _generate_description(
        self,
        script: str,
        title: str,
        niche: str,
        metadata: Dict
    ) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–ø–∏—Å–∞–Ω–∏–µ —Å —Ç–∞–π–º–∫–æ–¥–∞–º–∏"""

        # –ü–µ—Ä–≤—ã–π –∞–±–∑–∞—Ü (SEO-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π, –ø–µ—Ä–≤—ã–µ 150 —Å–∏–º–≤–æ–ª–æ–≤)
        first_para = script[:150].split('.')[0] + '.' if script else ''

        # –û—Å–Ω–æ–≤–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
        description = f"""–í —ç—Ç–æ–º –≤–∏–¥–µ–æ: {title}

{first_para}

üîî –ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –∫–∞–Ω–∞–ª —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—ã–µ –≤–∏–¥–µ–æ!
üëç –ü–æ—Å—Ç–∞–≤—å—Ç–µ –ª–∞–π–∫ –µ—Å–ª–∏ –≤–∏–¥–µ–æ –±—ã–ª–æ –ø–æ–ª–µ–∑–Ω—ã–º!
üí¨ –ü–∏—à–∏—Ç–µ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö —á—Ç–æ –¥—É–º–∞–µ—Ç–µ!

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üïê –¢–ê–ô–ú–ö–û–î–´:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

00:00 - –í–≤–µ–¥–µ–Ω–∏–µ
00:30 - –ì–ª–∞–≤–Ω–∞—è —Ç–µ–º–∞
02:15 - –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã
04:30 - –ü—Ä–∏–º–µ—Ä—ã
06:00 - –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üìö –ü–û–õ–ï–ó–ù–´–ï –°–°–´–õ–ö–ò:
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

üéØ –ù–∏—à–∞: {niche}
üì± Telegram: [–≤–∞—à –∫–∞–Ω–∞–ª]
üìß Email: [–≤–∞—à email]

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

#shorts #{niche.replace(' ', '')} #psychology #—Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ
"""

        return description

    def _generate_tags(self, title: str, niche: str, script: str) -> List[str]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 30 —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ç–µ–≥–æ–≤"""

        tags = []

        # –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–µ–≥–∏ –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞
        title_words = [w.lower() for w in title.split() if len(w) > 3]
        tags.extend([f"#{word}" for word in title_words[:5]])

        # –¢–µ–≥–∏ –Ω–∏—à–∏
        niche_tags = {
            '–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è': [
                '#–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è', '#—Å–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ', '#–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è–æ—Ç–Ω–æ—à–µ–Ω–∏–π',
                '#–ª–∏—á–Ω–æ—Å—Ç–Ω—ã–π—Ä–æ—Å—Ç', '#–ø—Å–∏—Ö–æ–ª–æ–≥', '#—Ç–æ–∫—Å–∏—á–Ω—ã–µ–ª—é–¥–∏',
                '#–º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è', '#—ç–º–æ—Ü–∏–∏', '#—á—É–≤—Å—Ç–≤–∞', '#–æ—Ç–Ω–æ—à–µ–Ω–∏—è'
            ],
            '–±–∏–∑–Ω–µ—Å': [
                '#–±–∏–∑–Ω–µ—Å', '#–ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª—å—Å—Ç–≤–æ', '#—Å—Ç–∞—Ä—Ç–∞–ø',
                '#–º–∞—Ä–∫–µ—Ç–∏–Ω–≥', '#–ø—Ä–æ–¥–∞–∂–∏', '#–¥–µ–Ω—å–≥–∏', '#—É—Å–ø–µ—Ö',
                '#–º–æ—Ç–∏–≤–∞—Ü–∏—è', '#–∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏', '#—Ñ–∏–Ω–∞–Ω—Å—ã'
            ],
            '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': [
                '#–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ', '#–æ–±—É—á–µ–Ω–∏–µ', '#–∑–Ω–∞–Ω–∏—è', '#—É—á—ë–±–∞',
                '#—Ä–∞–∑–≤–∏—Ç–∏–µ', '#–Ω–∞—É–∫–∞', '#—Ñ–∞–∫—Ç—ã', '#—É—á–∏—Ç–µ–ª—å',
                '#—à–∫–æ–ª–∞', '#—É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç'
            ]
        }

        # –î–æ–±–∞–≤–ª—è–µ–º —Ç–µ–≥–∏ –Ω–∏—à–∏
        for key in niche_tags:
            if key in niche.lower():
                tags.extend(niche_tags[key][:10])
                break

        # –û–±—â–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–µ–≥–∏
        general_tags = [
            '#youtube', '#–≤–∏–¥–µ–æ', '#shorts', '#viral',
            '#trending', '#–ø–æ–ø—É–ª—è—Ä–Ω–æ–µ', '#–∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ',
            '#–ø–æ–ª–µ–∑–Ω–æ', '#–ª–∞–π—Ñ—Ö–∞–∫–∏', '#—Å–æ–≤–µ—Ç—ã'
        ]

        tags.extend(general_tags[:10])

        # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã –∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–æ 30
        tags = list(dict.fromkeys(tags))[:30]

        return tags

    def _generate_stats(self, metadata: Dict) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –≤–∏–¥–µ–æ"""

        stats = f"""
–Ø–∑—ã–∫: {metadata.get('language', '–†—É—Å—Å–∫–∏–π')}
–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {self._format_duration(metadata.get('duration', 0))}
–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: {metadata.get('image_count', 'N/A')}
–°–ª–æ–≤ –≤ —Å–∫—Ä–∏–ø—Ç–µ: {metadata.get('word_count', 'N/A')}
–°—Ç–∏–ª—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: {metadata.get('style', 'N/A')}
–ì–æ–ª–æ—Å: {metadata.get('voice', 'N/A')}
–°—É–±—Ç–∏—Ç—Ä—ã: {metadata.get('subtitle_style', 'N/A')}
–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: {metadata.get('created_at', 'N/A')}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üéØ –ù–ò–®–ê: {metadata.get('niche', 'N/A')}
üé® –¶–ï–õ–ï–í–ê–Ø –ê–£–î–ò–¢–û–†–ò–Ø: {self._get_target_audience(metadata.get('niche', ''))}
üìà –ü–†–û–ì–ù–û–ó –ü–†–û–°–ú–û–¢–†–û–í: {self._estimate_views(metadata.get('niche', ''))}
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
"""

        return stats

    def _format_duration(self, seconds: float) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å"""
        if not seconds:
            return "N/A"
        minutes = int(seconds // 60)
        secs = int(seconds % 60)
        return f"{minutes}:{secs:02d}"

    def _get_target_audience(self, niche: str) -> str:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ü–µ–ª–µ–≤—É—é –∞—É–¥–∏—Ç–æ—Ä–∏—é"""
        audiences = {
            '–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è': '18-45 –ª–µ—Ç, –∏–Ω—Ç–µ—Ä–µ—Å—É—é—Ç—Å—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏–µ–π –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏—è–º–∏',
            '–±–∏–∑–Ω–µ—Å': '25-50 –ª–µ—Ç, –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–∏ –∏ –º–µ–Ω–µ–¥–∂–µ—Ä—ã',
            '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': '16-35 –ª–µ—Ç, —Å—Ç—É–¥–µ–Ω—Ç—ã –∏ —Å–∞–º–æ–æ–±—É—á–∞—é—â–∏–µ—Å—è',
            '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏': '18-40 –ª–µ—Ç, IT —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –∏ –≥–∏–∫–∏',
            '—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è': '14-35 –ª–µ—Ç, —à–∏—Ä–æ–∫–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è'
        }

        for key, audience in audiences.items():
            if key in niche.lower():
                return audience

        return '18-45 –ª–µ—Ç, —à–∏—Ä–æ–∫–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è'

    def _estimate_views(self, niche: str) -> str:
        """–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä—ã"""
        estimates = {
            '–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è': '10,000 - 50,000 (–ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü)',
            '–±–∏–∑–Ω–µ—Å': '5,000 - 25,000 (–ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü)',
            '–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': '8,000 - 40,000 (–ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü)',
            '—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏': '15,000 - 75,000 (–ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü)',
            '—Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è': '20,000 - 100,000 (–ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü)'
        }

        for key, estimate in estimates.items():
            if key in niche.lower():
                return estimate

        return '5,000 - 30,000 (–ø–µ—Ä–≤—ã–π –º–µ—Å—è—Ü)'
